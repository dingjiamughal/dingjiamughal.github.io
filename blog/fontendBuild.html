<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!-- <script src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js"></script> -->
    <title>Mughal Ding | 前端自动化构建</title>
    <meta name="description" content="你知道的 你微笑时好美">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/76.styles.c4a90679.css" as="style"><link rel="preload" href="/assets/js/app.6358a647.js" as="script"><link rel="preload" href="/assets/js/53.6312ed85.js" as="script"><link rel="prefetch" href="/assets/js/39.1c7a00e1.js"><link rel="prefetch" href="/assets/js/1.0fe49954.js"><link rel="prefetch" href="/assets/js/2.7cd9033a.js"><link rel="prefetch" href="/assets/js/3.9c329326.js"><link rel="prefetch" href="/assets/js/4.14d31d36.js"><link rel="prefetch" href="/assets/js/5.b68faf53.js"><link rel="prefetch" href="/assets/js/6.4936855e.js"><link rel="prefetch" href="/assets/js/7.6e112579.js"><link rel="prefetch" href="/assets/js/8.e4c98b39.js"><link rel="prefetch" href="/assets/js/9.dc8320b3.js"><link rel="prefetch" href="/assets/js/10.acc3df55.js"><link rel="prefetch" href="/assets/js/11.414a8557.js"><link rel="prefetch" href="/assets/js/12.310a8934.js"><link rel="prefetch" href="/assets/js/13.3786ce3c.js"><link rel="prefetch" href="/assets/js/14.201ae0fd.js"><link rel="prefetch" href="/assets/js/15.5b8827ae.js"><link rel="prefetch" href="/assets/js/16.49192f09.js"><link rel="prefetch" href="/assets/js/17.106bff9e.js"><link rel="prefetch" href="/assets/js/18.54ecc957.js"><link rel="prefetch" href="/assets/js/19.86bdad01.js"><link rel="prefetch" href="/assets/js/20.fb456475.js"><link rel="prefetch" href="/assets/js/21.63d9c981.js"><link rel="prefetch" href="/assets/js/22.32a3a63c.js"><link rel="prefetch" href="/assets/js/23.fcd85565.js"><link rel="prefetch" href="/assets/js/24.1f053775.js"><link rel="prefetch" href="/assets/js/25.63091b6c.js"><link rel="prefetch" href="/assets/js/26.a163923b.js"><link rel="prefetch" href="/assets/js/27.61562fc2.js"><link rel="prefetch" href="/assets/js/28.b7552351.js"><link rel="prefetch" href="/assets/js/29.d08474f0.js"><link rel="prefetch" href="/assets/js/30.ce15f327.js"><link rel="prefetch" href="/assets/js/31.265f6667.js"><link rel="prefetch" href="/assets/js/32.2d6228d2.js"><link rel="prefetch" href="/assets/js/33.23fbdb4b.js"><link rel="prefetch" href="/assets/js/34.e0547159.js"><link rel="prefetch" href="/assets/js/35.5cd7225b.js"><link rel="prefetch" href="/assets/js/36.7d41ebb9.js"><link rel="prefetch" href="/assets/js/37.e77a11ff.js"><link rel="prefetch" href="/assets/js/38.60c027ce.js"><link rel="prefetch" href="/assets/js/0.2bf1f4a8.js"><link rel="prefetch" href="/assets/js/40.799d1b85.js"><link rel="prefetch" href="/assets/js/41.7538598d.js"><link rel="prefetch" href="/assets/js/42.7dae9c74.js"><link rel="prefetch" href="/assets/js/43.336735e0.js"><link rel="prefetch" href="/assets/js/44.24e5c899.js"><link rel="prefetch" href="/assets/js/45.5b753c9b.js"><link rel="prefetch" href="/assets/js/46.cbf3e8c5.js"><link rel="prefetch" href="/assets/js/47.ff9d0602.js"><link rel="prefetch" href="/assets/js/48.f4c40098.js"><link rel="prefetch" href="/assets/js/49.f2d922e7.js"><link rel="prefetch" href="/assets/js/50.d393095a.js"><link rel="prefetch" href="/assets/js/51.15f61158.js"><link rel="prefetch" href="/assets/js/52.55122e51.js"><link rel="prefetch" href="/assets/js/54.20f1d10b.js"><link rel="prefetch" href="/assets/js/55.de54defe.js"><link rel="prefetch" href="/assets/js/56.3e445503.js"><link rel="prefetch" href="/assets/js/57.dadcf477.js"><link rel="prefetch" href="/assets/js/58.c6eba1d0.js"><link rel="prefetch" href="/assets/js/59.a1ec926a.js"><link rel="prefetch" href="/assets/js/60.84365db1.js"><link rel="prefetch" href="/assets/js/61.28c2c85b.js"><link rel="prefetch" href="/assets/js/62.edc28c29.js"><link rel="prefetch" href="/assets/js/63.797e4411.js"><link rel="prefetch" href="/assets/js/64.d718e0b5.js"><link rel="prefetch" href="/assets/js/65.ec9b6325.js"><link rel="prefetch" href="/assets/js/66.04e4851f.js"><link rel="prefetch" href="/assets/js/67.36ff154b.js"><link rel="prefetch" href="/assets/js/68.1b38fcd1.js"><link rel="prefetch" href="/assets/js/69.a59b8c2b.js"><link rel="prefetch" href="/assets/js/70.7c69b3fa.js"><link rel="prefetch" href="/assets/js/71.cb939bc2.js"><link rel="prefetch" href="/assets/js/72.80e3b90a.js"><link rel="prefetch" href="/assets/js/73.84d3fdf3.js"><link rel="prefetch" href="/assets/js/74.0bf387c6.js"><link rel="prefetch" href="/assets/js/75.eeb706fb.js">
    <link rel="stylesheet" href="/assets/css/76.styles.c4a90679.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div class="bdsharebuttonbox"><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="qzone" class="bds_qzone"></a><a href="#" data-cmd="tsina" class="bds_tsina"></a><a href="#" data-cmd="tqq" class="bds_tqq"></a><a href="#" data-cmd="renren" class="bds_renren"></a><a href="#" data-cmd="weixin" class="bds_weixin"></a></div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Mughal Ding
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/webpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="https://www.xhrsama.com/resume/" target="_blank" rel="noopener noreferrer" class="nav-link">Resume</a></div><div class="nav-item"><a href="/aboutme/" class="nav-link">About me</a></div><div class="nav-item"><a href="/NM$L6324UpUp/" class="nav-link"></a></div><a href="https://github.com/dingjiamughal/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/webpack/" class="nav-link">Webpack</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="https://www.xhrsama.com/resume/" target="_blank" rel="noopener noreferrer" class="nav-link">Resume</a></div><div class="nav-item"><a href="/aboutme/" class="nav-link">About me</a></div><div class="nav-item"><a href="/NM$L6324UpUp/" class="nav-link"></a></div><a href="https://github.com/dingjiamughal/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>dingjia</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/blog/fontendBuild.html" class="active sidebar-link">前端自动化构建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/fontendBuild.html#什么是自动化构建，好处是什么" class="sidebar-link">什么是自动化构建，好处是什么</a></li><li class="sidebar-sub-header"><a href="/blog/fontendBuild.html#如何进行自动化构建" class="sidebar-link">如何进行自动化构建</a></li></ul></li><li><a href="/blog/interview-1.html" class="sidebar-link">百度金融SSG的面试经历(1面)</a></li><li><a href="/blog/interview-2.html" class="sidebar-link">百度金融SSG的面试经历(2面)</a></li><li><a href="/blog/interview-3.html" class="sidebar-link">百度金融SSG的面试经历(最终面)</a></li><li><a href="/blog/fe-optimize.html" class="sidebar-link">前端性能优化</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>html</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>css</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>javascript</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>es6</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>nginx</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="前端自动化构建"><a href="#前端自动化构建" aria-hidden="true" class="header-anchor">#</a> 前端自动化构建</h1><p>随着web应用的不断复杂化，前端自动化构建已成为当今前端开发中必不可少的一部分。
</p><ul><li>什么是自动化构建、自动化构建的好处是什么</li><li>如何进行自动化构建</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Simple Usage、Efficient Builds、Quality Ecosystem</p></div><p>这是gulp对其构建工具的优点介绍，通俗的说就是让简单的任务简单，复杂的任务可管理</p><h3 id="一些问题"><a href="#一些问题" aria-hidden="true" class="header-anchor">#</a> 一些问题</h3><p>翻开n年前的老项目的前端代码，总结出几点：</p><ul><li>前后端不分离，页面上会出现后台逻辑，也许是为了高性能高seo，不过现在的mvvm框架都可实现服务端渲染。</li><li>代码量巨大，各种文件引入，不易维护。</li><li>工具函数复杂 + 满天飞的第三方类库，不易维护。</li><li>无法做到模块的动态复用，不易维护</li><li>无法进行自动化的对css预处理语言以及es6/7语法进行编译以及模块的热更新，影响开发效率</li></ul><p>现在看来，以上的任何一点都极大的影响了工作效率，如果是这样，那是时候对项目进行自动化构建了。</p><h2 id="什么是自动化构建，好处是什么"><a href="#什么是自动化构建，好处是什么" aria-hidden="true" class="header-anchor">#</a> 什么是自动化构建，好处是什么</h2><p>我个人理解，构建就是页面中的一个个模块：html代码片段，js代码片段，css函数式编程甚至一张图片都可成一模块，我们在开发过程中（开发环境）对这些模块进行组装，最终生成静态文件，这个组装的过程就是自动化构建。<br>
自动化构建的优势在于，可以完美解决以上的所有问题。随着前端业务量的不断增加，同时会用到各种第三方类库，自动化构建就能很好的帮助我们进行维护和管理，提高代码性能。</p><h2 id="如何进行自动化构建"><a href="#如何进行自动化构建" aria-hidden="true" class="header-anchor">#</a> 如何进行自动化构建</h2><h3 id="javascript的构建"><a href="#javascript的构建" aria-hidden="true" class="header-anchor">#</a> JavaScript的构建</h3><p>传统的做法是引入script标签，如果文件多就难以管理，对js进行构建，我们只需要一个js文件就可以包含所有的js代码，同时也可使别的语言编译成js，例如<code>ts</code>,<code>cs</code>、<code>es6/7</code>，当然本文的重点是解决问题，所以抛出了第一个问题，以angularjs为例<br>
我们要实现一个基础的添加数据、删除数据、页面渲染，最粗暴的方式就是写在一块，但是会很乱，我们想到的方法可以用全局变量定义<code>controller</code></p><pre class="language-js"><code><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'$scope'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'$scope'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> c<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'$scope'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
  angular<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'Controller'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'Controller'</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'Controller'</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
</code></pre><p>这样做法的问题是全局变量的污染，当一个大型项目出现N个全局变量的时候，就真心无力调试了，但凡给我们开发或者维护带来不便那就都是bug，为解决此类问题，这里引出一款入门级的构建工具<code>Browserify</code>来实现js的模块化加载，<a href="https://github.com/browserify/browserify#usage" target="_blank" rel="noopener noreferrer">browserify api</a>。</p><blockquote><p>npm install browserify -g</p></blockquote><p><code>Browserify</code>中支持<code>commonJS</code>模块规范，使用<code>module.exports</code>定义js模块，<code>require</code>来加载js模块</p><pre class="language-js"><code><span class="token comment">//定义</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'$scope'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token comment">//使用</span>
angular<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'Controller'</span><span class="token punctuation">,</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./xxx.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><p>这样我们就完成了模块化的第一步，然后就可以启动命令，模块就会被打包成一个js文件</p><blockquote><p>browserify xxx.js -o main.js</p></blockquote><p>为了避免每次修改要运行一次命令，我们需要自动化构建，来配置文件模拟打包过程，从而使得每次开发只需要编写开发代码即可。</p><h3 id="gulp"><a href="#gulp" aria-hidden="true" class="header-anchor">#</a> gulp</h3><p>提到自动化构建，最具有代表性的一定是<code>gulp</code>，因为这很js，流式结构也可以深刻理解构建过程，如果有一定自动化构建基础想了解webpack的可以跳转至我的<a href="http://www.xhrsama.com/vuepress/webpack" target="_blank" rel="noopener noreferrer">webpack教程</a>。附上演示代码</p><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-load-plugins'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> open <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> gulpif <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-if'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uglify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-uglify'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> minifyCss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-clean-css'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// src：source文件、build：开发文件、dist：上线文件</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token punctuation">{</span>
  srcPath<span class="token punctuation">:</span> <span class="token string">'src/'</span><span class="token punctuation">,</span>
  devPath<span class="token punctuation">:</span> <span class="token string">'build/'</span><span class="token punctuation">,</span>
  prdPath<span class="token punctuation">:</span> <span class="token string">'dist/'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'font'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'font/**/*'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>devPath <span class="token operator">+</span> <span class="token string">'font'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>prdPath <span class="token operator">+</span> <span class="token string">'font'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'views/**/*.html'</span><span class="token punctuation">)</span> <span class="token comment">//拷贝html</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>devPath <span class="token operator">+</span> <span class="token string">&quot;views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">useref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span><span class="token string">'*.js'</span><span class="token punctuation">,</span> <span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span><span class="token string">'*.css'</span><span class="token punctuation">,</span> <span class="token function">minifyCss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>prdPath <span class="token operator">+</span> <span class="token string">&quot;views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'less'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'style/less/**/*.less'</span><span class="token punctuation">)</span> <span class="token comment">//编译less文件</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">plumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">less</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//less编译为css</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>devPath <span class="token operator">+</span> <span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">cssmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//css压缩</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>prdPath <span class="token operator">+</span> <span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'js/**/*.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">plumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>devPath <span class="token operator">+</span> <span class="token string">'js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//js压缩</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>prdPath <span class="token operator">+</span> <span class="token string">'js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'images/*.{png,jpg,gif,ico}'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">plumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>devPath <span class="token operator">+</span> <span class="token string">'images'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">imagemin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      progressive<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>prdPath <span class="token operator">+</span> <span class="token string">'images'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'font'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token string">'less'</span><span class="token punctuation">,</span> <span class="token string">'html'</span> <span class="token punctuation">,</span><span class="token string">'js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//build运行全部</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'clean'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span>app<span class="token punctuation">.</span>devPath<span class="token punctuation">,</span> app<span class="token punctuation">.</span>prdPath<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'serve'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'build'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">/</span><span class="token operator">/</span>server task运行build集合
  $<span class="token punctuation">.</span>connect<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    root<span class="token punctuation">:</span> <span class="token punctuation">[</span>app<span class="token punctuation">.</span>devPath<span class="token punctuation">]</span><span class="token punctuation">,</span>
    livereload<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token operator">/</span><span class="token operator">/</span>热更新
    port<span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3001/views/clarins-login.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'views/**/*.html'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'html'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'style/less/**/*.less'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'less'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'js/**/*.js'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>srcPath <span class="token operator">+</span> <span class="token string">'images/**/*'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输入gulp 即可自动运行 serve任务</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'serve'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>gulp通过流的方式，一步步的传递下去直到业务代码结束。一个任务的整个过程大致分为：检索文件、拷贝、业务处理（编译、压缩），最后再启动本地服务。<br>
言归正传先不细说gulp，回到browsrify，之前的问题是我们完成了用模块化的方式定义js并完成了一个简单构建。<br>
现在需要对其进行自动化构建，browerify是办不到的必须借助gulp来完成。
方法一：在node中执行shell脚本来运行browserify。首先得下载<code>shell</code>模块<code>npm install shelljs --save-dev</code></p><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> shelljs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'shelljs'</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  shelljs<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'browserify xxx.js -o main.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>方法二：browserify内置方法</p><blockquote><p>npm install browserify</p></blockquote><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> browserify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'browserify'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">tast</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'xxx.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>于是我们就完成了最基本的文件打包（将n个模块打包成一份js文件），在解决模块化引用之后，接下来就是顺应gulp流规范来解决更多的问题了，我们要对前端所有静态资源进行自动化的构建。
gulp使用中会经常用到<code>pipe</code>，这是gulp语法糖，可以理解成进程和进程间的连接。<br>
具体的api可以参考<a href="https://www.gulpjs.com.cn/docs/api/" target="_blank" rel="noopener noreferrer"> gulp中文网 </a><br>
gulp中，<code>default</code>为唯一输出任务，gulp最终执行的是default任务下的回调，意思就是我们必须把构建配置写在default的回调下，多任务就以数组形式['taskname1','taskname2','taskname3'···]，数组中的task可以配置多种功能。</p><pre class="language-js"><code>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'font'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token string">'less'</span><span class="token punctuation">,</span> <span class="token string">'html'</span> <span class="token punctuation">,</span><span class="token string">'js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><p>也可借助外部模块<code>run-sequence</code>来帮助管理任务之间的相互调用，和数组功能一样</p><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> browserify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'browserify'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="highlighted-line"><span class="token keyword">const</span> requence <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'run-sequence'</span><span class="token punctuation">)</span></span>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'xxx.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'xxx.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="highlighted-line">      <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">)</span></span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="highlighted-line">  <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span><span class="token string">'watch'</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>综上，我们实现了一个自动化构建的demo，每次只需要启动gulp，就可以完成自动化的编译打包。现在我们对代码进行下优化，用<code>watchify</code>代替，使用 watchify 加速 browserify 编译，<a href="https://www.gulpjs.com.cn/docs/recipes/fast-browserify-builds-with-watchify/" target="_blank" rel="noopener noreferrer">文档</a><br>
对上面的代码进行改造</p><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> browserify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'browserify'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> requence <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'run-sequence'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> watchify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'watchify'</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    entries<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'xxx.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    cache<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    packageCache<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugin<span class="token punctuation">:</span> <span class="token punctuation">[</span>watchify<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h3 id="browserify-构建第三方类库"><a href="#browserify-构建第三方类库" aria-hidden="true" class="header-anchor">#</a> browserify 构建第三方类库</h3><p>例如jQuery、lodash、angularjs，通常是公共的，我们就可以使用browserify将这些文件打包成一个js文件，既方便我们管理，又能够减少请求。<br>
接下来就开启第三方类库的任务：</p><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> browserify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'browserify'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> requence <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'run-sequence'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> watchify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'watchify'</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    entries<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'xxx.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    cache<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    packageCache<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugin<span class="token punctuation">:</span> <span class="token punctuation">[</span>watchify<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">external</span><span class="token punctuation">(</span><span class="token string">'angular'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">external</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'vendor'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./bower_components/angular.js'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    expose<span class="token punctuation">:</span><span class="token string">'angular'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./bower_components/lodash.js'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    expose<span class="token punctuation">:</span><span class="token string">'lodash'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/vendor.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span><span class="token string">'vendor'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><p>这样在<code>vendor.js</code>中就集成了angular和lodash，完成了对第三方类库的打包，但是我们必须在页面中<code>require</code>模块，由于是按照browserify规则的进行打包，引入文件要用commonjs规范，否则浏览器会报错。但是就算是我们完成了上述的所有，对于angular来讲也是不行的，因为angularjs不能使用commonjs规范，依旧会报错。<br>
为了解决这个问题，我们需要借助<a href="https://github.com/thlorenz/browserify-shim" target="_blank" rel="noopener noreferrer">browserify-shim</a>，官网对其定义： Makes CommonJS incompatible files browserifyable，解决在browserify中使用commonjs规范，接下来配置一发</p><blockquote><p>npm install browserify-shim -save-dev</p></blockquote><pre class="language-js"><code><span class="token comment">// package.json</span>
<span class="token string">&quot;browserify&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;transform&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;browserify-shim&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token string">&quot;browserify-shim&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;angular&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;angular&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;_&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">//我们还需要定义别名 use aliases</span>
<span class="token string">&quot;browser&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;angular&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bower_components/angular.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bower_components/lodash.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre><p>有了browserif-shim，我们就不需要进行<code>vendor</code>任务了，构建代码又回到之前的样子</p><pre class="language-js"><code><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> browserify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'browserify'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> requence <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'run-sequence'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> watchify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'watchify'</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    entries<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'xxx.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    cache<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    packageCache<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugin<span class="token punctuation">:</span> <span class="token punctuation">[</span>watchify<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'js/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h3 id="jsuglify"><a href="#jsuglify" aria-hidden="true" class="header-anchor">#</a> JsUglify</h3><p>JsUglify的作用就是处理简化js文件，gulp中叫做<a href="https://github.com/terinjokes/gulp-uglify" target="_blank" rel="noopener noreferrer">gulp-uglify</a>，它依赖于uglify.js</p><blockquote><p>npm install gulp-uglify --save-dev <br>
npm insall vinyl-source-stream --save-dev <br>
npm install vinyl-buffer --save-dev <br></p></blockquote><pre class="language-js"><code><span class="token keyword">const</span> uglify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-uglify'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vinyl-source-stream'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vinyl-buffer'</span><span class="token punctuation">)</span>

b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token string">'main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'js/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><h3 id="gulp-if-给gulp加入判断"><a href="#gulp-if-给gulp加入判断" aria-hidden="true" class="header-anchor">#</a> gulp-if 给gulp加入判断</h3><p>了解webpack的同学可能了解<code>node_env</code>环境变量的概念，在gulp中可以使用<code>gulp-if</code>来区分开发版本和生产版本，例如之前的uglify，我们只需要在生产版本运行就行了，开发版本则不需要</p><blockquote><p>npm install gulp-if --save-dev</p></blockquote><pre class="language-js"><code><span class="token keyword">const</span> gulpif <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-if'</span><span class="token punctuation">)</span>
<span class="token comment">//这里解释一下 process.env.ENV</span>
<span class="token comment">// process为整个进程</span>
<span class="token comment">// env为进程中的环境变量</span>
<span class="token comment">// ENV为环境变量中名为ENV的环境变量</span>
需要检测一下是prod还是dev
<span class="token keyword">const</span> isProd <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ENV</span> <span class="token operator">===</span> <span class="token string">'prod'</span>
b<span class="token punctuation">.</span><span class="token function">bundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token string">'main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span>isProd<span class="token punctuation">,</span><span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'js/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><p>然后再生产版本打包时，命令行中输入<code>ENV=prod gulp</code></p><h3 id="编译es6"><a href="#编译es6" aria-hidden="true" class="header-anchor">#</a> 编译es6</h3><p>编译es6的工具是<code>babel</code>，我们在gulp中配置一下，让所有的js文件中支持es6语法</p><blockquote><p>npm install gulp-babel --save-dev
npm install babel-preset-es2015</p></blockquote><pre class="language-js"><code><span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-babel'</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'babel'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./assets/js/*.js'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        presets<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'./build/js/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'babelWatch'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'assets/js/*.js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'babel'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'babel'</span><span class="token punctuation">,</span><span class="token string">'babelWatch'</span><span class="token punctuation">,</span><span class="token string">'js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>我们单独把babel配置拉出来，新建<code>.babelrc</code></p><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="处理css"><a href="#处理css" aria-hidden="true" class="header-anchor">#</a> 处理css</h3><p>css是前端开发中重要的部分，因此我们也需要对css文件进行自动化压缩和编译。<br></p><h4 id="代码压缩"><a href="#代码压缩" aria-hidden="true" class="header-anchor">#</a> 代码压缩</h4><blockquote><p>npm install gulp-clean-css --save-dev
npm install gulp-concat --save-dev</p></blockquote><pre class="language-js"><code><span class="token keyword">const</span> cleanCss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-clean-css'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> concat <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-concat'</span><span class="token punctuation">)</span><span class="token comment">//合并代码</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'minifyCss'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./assets/css/*.css'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'main.css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cleanCss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'css/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'minifyCssWatch'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'./assets/css/*.css'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'minifyCss'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h4 id="编译css预处理语言"><a href="#编译css预处理语言" aria-hidden="true" class="header-anchor">#</a> 编译css预处理语言</h4><blockquote><p>npm install gulp-sass --save-dev</p></blockquote><pre class="language-js"><code><span class="token keyword">const</span> gulpSass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-sass'</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'sass'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./assets/css/main.scss'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">sass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">gulpif</span><span class="token punctuation">(</span>isProd<span class="token punctuation">,</span><span class="token function">cleanCss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'css/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">gulp</span><span class="token punctuation">(</span><span class="token string">'sassWatch'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'./assets/css*.scss'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">sequence</span><span class="token punctuation">(</span><span class="token string">'sass'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3><p>我们完成了一个最基础的前端的自动化构建。构建的好处不用再阐述了，作为前端静态资源，html、css、js我们通过自动话构建，帮我们尽可能的轻松开发和完成业务需求，一方面是为了省力，另一方面也比较有趣。</p></div><div class="content edit-link"><a href="https://github.com/dingjiamughal/vuepress/edit/master/docs/blog/fontendBuild.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="content page-nav"><p class="inner"><!----><span class="next"><a href="/blog/interview-1.html">
          百度金融SSG的面试经历(1面)
        </a> →
      </span></p></div><div class="bsa-cpc-wrapper"><div class="bsa-cpc"></div></div></div></div></div>
    <script src="/assets/js/53.6312ed85.js" defer></script><script src="/assets/js/app.6358a647.js" defer></script>
  </body>
</html>
